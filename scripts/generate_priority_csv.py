import csv
import datetime as dt
from pathlib import Path

data = [
    (1,"Озеро Карасор","Карагандинская","озеро","пресная",1,"2014-06-12",4,49.8231,72.1474,"/pdfs/karasor.pdf"),
    (2,"Канал Иртыш-Караганда","Павлодарская","канал","пресная",0,"2003-04-02",5,52.3212,76.9013,"/pdfs/irtysh.pdf"),
    (3,"Водохранилище Капчагай","Алматинская","водохранилище","пресная",1,"2019-03-18",3,43.8512,77.1128,"/pdfs/kapchagai.pdf"),
    (4,"Озеро Алаколь","Алматинская","озеро","непресная",1,"2010-07-07",2,46.1682,81.6731,"/pdfs/alakol.pdf"),
    (5,"ГТС Сарыозек","Жетысу","водохранилище","пресная",0,"2001-09-21",5,45.1231,78.2155,"/pdfs/saryozek.pdf"),
    (6,"Канал Тургай","Костанайская","канал","пресная",0,"2016-11-30",1,49.6231,63.4512,"/pdfs/turgai.pdf"),
    (7,"Озеро Балхаш","Алматинская","озеро","непресная",1,"2008-04-15",4,46.8582,74.9814,"/pdfs/balkhash.pdf"),
    (8,"ГТС Аягоз","ВКО","водохранилище","пресная",0,"2013-12-03",3,47.9567,80.4521,"/pdfs/ayagoz.pdf"),
    (9,"Озеро Маркаколь","ВКО","озеро","пресная",1,"2021-08-11",2,48.6351,85.7012,"/pdfs/markakol.pdf"),
    (10,"Канал Шу-Илийский","Жамбылская","канал","пресная",0,"2005-10-17",5,43.3821,73.1028,"/pdfs/shu.pdf"),
    (11,"Озеро Тенгиз","Акмолинская","озеро","непресная",1,"2009-03-12",3,50.5012,69.2341,"/pdfs/tengiz.pdf"),
    (12,"ГТС Есиль","Акмолинская","водохранилище","пресная",0,"2018-01-06",2,51.1512,71.4231,"/pdfs/yesil.pdf"),
    (13,"Озеро Саумалколь","СКО","озеро","пресная",1,"2011-02-22",4,53.1234,69.9834,"/pdfs/saumalkol.pdf"),
    (14,"Канал Жайык","ЗКО","канал","пресная",0,"2002-06-19",5,51.2233,51.3321,"/pdfs/zhaiyk.pdf"),
    (15,"ГТС Индер","Атырауская","водохранилище","непресная",0,"2017-09-27",3,48.5632,51.9628,"/pdfs/inder.pdf"),
    (16,"Озеро Кургандык","Актюбинская","озеро","пресная",0,"2015-05-14",2,49.2211,57.3121,"/pdfs/kurgandyk.pdf"),
    (17,"Озеро Шалкар","Актюбинская","озеро","пресная",1,"2007-08-11",3,48.9221,59.1241,"/pdfs/shalkar.pdf"),
    (18,"ГТС Уштобе","Жетысу","водохранилище","пресная",0,"2004-11-30",4,45.7311,78.9912,"/pdfs/ushtobe.pdf"),
    (19,"Озеро Жаланашколь","Алматинская","озеро","непресная",1,"2013-03-18",2,46.3221,82.1234,"/pdfs/zhalanashkol.pdf"),
    (20,"Канал Арыс-Туркестан","Туркестанская","канал","пресная",0,"2010-10-10",5,42.3211,69.8821,"/pdfs/arys.pdf"),
    (21,"Озеро Иссык","Алматинская","озеро","пресная",1,"2020-06-12",1,43.3551,77.1192,"/pdfs/issyq.pdf"),
    (22,"Водохранилище Бухтарма","ВКО","водохранилище","пресная",1,"2003-01-02",4,49.6233,83.5121,"/pdfs/buhtarma.pdf"),
    (23,"Озеро Сасыкколь","Алматинская","озеро","непресная",1,"2016-09-21",3,45.9812,78.9911,"/pdfs/sasykkol.pdf"),
    (24,"ГТС Кентау","Туркестанская","водохранилище","пресная",0,"2011-05-15",2,43.5111,68.2112,"/pdfs/kentau.pdf"),
    (25,"Озеро Колсай-1","Алматинская","озеро","пресная",1,"2014-04-10",3,42.9862,78.3221,"/pdfs/kolsay1.pdf"),
    (26,"Озеро Колсай-2","Алматинская","озеро","пресная",1,"2018-06-05",1,42.9952,78.3155,"/pdfs/kolsay2.pdf"),
    (27,"Озеро Каинды","Алматинская","озеро","пресная",1,"2012-07-08",4,42.9551,78.4421,"/pdfs/kaindy.pdf"),
    (28,"ГТС Боралдай","Туркестанская","водохранилище","пресная",0,"2006-02-03",5,42.4211,69.1211,"/pdfs/boraldai.pdf"),
    (29,"Канал Сырдарья-Северо-Казахстанский","Кызылординская","канал","пресная",0,"2001-01-14",5,44.5121,65.3122,"/pdfs/syrdarya.pdf"),
    (30,"Озеро Жалаулы","Павлодарская","озеро","пресная",1,"2017-11-10",2,52.1234,77.5121,"/pdfs/zhalauly.pdf"),
    (31,"ГТС Карабулак","Туркестанская","водохранилище","пресная",0,"2021-03-22",1,42.9812,69.1121,"/pdfs/karabulak.pdf"),
    (32,"Озеро Шубарколь","Карагандинская","озеро","пресная",1,"2008-10-31",4,49.3421,72.8211,"/pdfs/shubarkol.pdf"),
    (33,"ГТС Шульбинское","ВКО","водохранилище","пресная",1,"2002-02-20",5,49.9821,82.6121,"/pdfs/shulbinsk.pdf"),
    (34,"Озеро Сырты","Актюбинская","озеро","непресная",0,"2015-08-26",3,48.5121,57.2211,"/pdfs/syrty.pdf"),
    (35,"Канал Кировский","СКО","канал","пресная",0,"2010-11-18",4,54.1121,69.8421,"/pdfs/kirov.pdf"),
    (36,"ГТС Омбы","Павлодарская","водохранилище","пресная",1,"2014-12-12",2,52.9912,76.8912,"/pdfs/omby.pdf"),
    (37,"Озеро Шаган","ЗКО","озеро","непресная",1,"2016-07-28",3,50.0121,51.2211,"/pdfs/shagan.pdf"),
    (38,"ГТС Аксу","Павлодарская","водохранилище","пресная",0,"2003-03-03",5,52.3112,77.1211,"/pdfs/aksu.pdf"),
    (39,"Озеро Тобыл","Костанайская","озеро","пресная",1,"2020-09-09",1,53.2012,63.5111,"/pdfs/tobyl.pdf"),
    (40,"Озеро Кушмурун","Костанайская","озеро","непресная",1,"2012-06-12",4,52.6311,64.1121,"/pdfs/kushm.pdf"),
    (41,"Канал Бухтарминский","ВКО","канал","пресная",0,"2013-02-02",3,49.7651,83.2121,"/pdfs/buhtarm_channel.pdf"),
    (42,"Канал Капшагайский","Алматинская","канал","пресная",0,"2009-04-10",5,43.9512,77.9912,"/pdfs/kapch_channel.pdf"),
    (43,"Озеро Арасан","Туркестанская","озеро","пресная",1,"2015-12-01",2,42.6512,68.3121,"/pdfs/arasan.pdf"),
    (44,"ГТС Шардара","Туркестанская","водохранилище","пресная",1,"2007-03-19",4,41.2521,67.9721,"/pdfs/shardara.pdf"),
    (45,"Озеро Акколь","Актюбинская","озеро","пресная",1,"2018-08-08",1,49.0211,57.8912,"/pdfs/akkol.pdf"),
    (46,"Канал Улькен","Жетысу","канал","пресная",0,"2011-11-11",5,45.8912,79.1211,"/pdfs/ulken.pdf"),
    (47,"ГТС Балбулак","Атырауская","водохранилище","непресная",0,"2005-06-14",5,47.9812,52.1121,"/pdfs/balbulak.pdf"),
    (48,"Озеро Алабугыр","ВКО","озеро","пресная",1,"2019-04-12",2,48.7121,84.5121,"/pdfs/alabugyr.pdf"),
    (49,"Озеро Жайсан","Алматинская","озеро","непресная",1,"2017-03-03",3,46.5121,82.8121,"/pdfs/zhais.pdf"),
    (50,"Канал Талдыколь","Алматинская","канал","пресная",0,"2014-01-02",2,43.3211,77.2421,"/pdfs/taldykol.pdf"),
]

def generate_csv(path: Path) -> None:
    today_year = dt.date.today().year
    path.parent.mkdir(parents=True, exist_ok=True)
    with path.open("w", newline="", encoding="utf-8") as f:
        writer = csv.writer(f)
        writer.writerow([
            "id",
            "name",
            "region",
            "resource_type",
            "water_type",
            "fauna",
            "passport_date",
            "technical_condition",
            "latitude",
            "longitude",
            "pdf_url",
            "priority",
        ])
        for row in data:
            (
                rid,
                name,
                region,
                resource_type,
                water_type,
                fauna,
                passport_date,
                technical_condition,
                latitude,
                longitude,
                pdf_url,
            ) = row
            age = today_year - int(passport_date[:4])
            priority = (6 - int(technical_condition)) * 3 + age
            writer.writerow([
                rid,
                name,
                region,
                resource_type,
                water_type,
                fauna,
                passport_date,
                technical_condition,
                latitude,
                longitude,
                pdf_url,
                priority,
            ])


def main() -> None:
    generate_csv(Path("data/sample_priority.csv"))


if __name__ == "__main__":
    main()
